<!DOCTYPE html>

<html>

<head>

    <meta charset='utf-8' />

    <title>Pillar App Site Map</title>

    <meta http-equiv='Cache-Control' content='no-cache, no-store, must-revalidate' />
    <meta http-equiv='Pragma' content='no-cache' />
    <meta http-equiv='Expires' content='0' />

    <meta name='viewport' content='initial-scale=1,maximum-scale=1,user-scalable=no' />

    <link href='https://api.mapbox.com/mapbox-gl-js/v3.3.0/mapbox-gl.css' rel='stylesheet' />
    <link href='styles.css' rel='stylesheet' />

    <script src='https://api.mapbox.com/mapbox-gl-js/v3.3.0/mapbox-gl.js'></script>
    <script id="search-js" defer="" src="https://api.mapbox.com/search-js/v1.0.0-beta.20/web.js"></script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.0/papaparse.min.js"></script>

</head>

<body>

    <div class="map-container">

        <div id='map'></div>

        <!-- legend for filtering -->
        <div class="map-overlay top">
            <div class="map-overlay-inner">

                <fieldset>
                    <label class="visible-layers-label">Visible Layers</label>
                </fieldset>
                <fieldset>
                    <input type="checkbox" id="OpsVision" checked="">
                    <label for="OpsVision">OpsVision</label>
                </fieldset>
                <fieldset>
                    <input type="checkbox" id="Reliance" checked="">
                    <label for="Reliance">Reliance</label>
                </fieldset>
                <fieldset>
                    <input type="checkbox" id="Maximo" checked="">
                    <label for="Maximo">Maximo</label>
                </fieldset>
                <fieldset>
                    <input type="checkbox" id="SCC" checked="">
                    <label for="SCC">SCC</label>
                </fieldset>
                <fieldset>
                    <input type="checkbox" id="All-Sites" checked="">
                    <label for="All-Sites">All Sites</label>
                </fieldset><br>
            </div>
        </div>

        <!--Map settings dropdowns-->
        <div class="dropdown-container">

            <div id="projection-dropdown">
                <label for="projection-select">Projection</label><br>
                <select id="projection-select">
                    <option value="globe">3D Globe</option>
                    <option value="naturalEarth">Flat Map</option>
                </select>
            </div>

            <div id="menu">
                <label for="map-type-select">Map Style</label><br>
                <select id="map-type-select">
                    <option value="streets-v12">Standard</option>
                    <option value="satellite-streets-v12">Satellite</option>
                    <option value="light-v11">Light</option>
                    <option value="dark-v11">Dark</option>
                </select>
            </div>

        </div>

        <!--"Upload Data" button-->
        <div class="file-upload-container">
            <button  onclick="showPopup('upload-popup')"><img id="upload-img" src="assets/images/upload.svg" alt="Upload Icon"> Upload Data</button>
        </div>

        <!-- Popup containers -->
        <div id="upload-popup" class="popup-container">
            <span class="close-btn" onclick="hidePopup('upload-popup')"><img id="x-img" src="assets/images/x.svg" alt="Close Popup X Icon"></span>
            <label id="upload-data-popup-label"><img id="upload-img" src="assets/images/upload.svg" alt="Upload Icon"> Upload Data</label>
            <br>
            <p class="subtext"><strong>Note: Changes to the datasets used in this map will reflect for all users.</strong><br><br>
            Use the latest version of the "masterSiteListing" sheet in the "Site_Pillar_Apps_Roadmaps" Excel file to 
            update the master site listing data (save and upload a .csv copy). <br><br>

            Use the latest version of the "Current install base" sheet in the "Site_Pillar_Apps_Roadmaps" Excel file to update
            the master site listing data (save and upload a .csv copy).
            </p>
            <form>
                <label for="master-sites-upload" class="subtext"><strong>Master Site List</strong></label><br>
                <input type="file" id="master-sites-upload" name="master-sites-upload" accept=".csv" />
                <input type="button" id="apply-master-sites-upload" value="Apply">
            </form>
            <br>
            <form>
                <label for="app-deployment-upload" class="subtext"><strong>Pillar App Deployment Data</strong></label><br>
                <input type="file" id="app-deployment-upload" name="app-deployment-upload" accept=".csv" />
                <input type="button" id="apply-app-deployment-upload" value="Apply">
            </form>
        </div>
        
    </div>

    <script>
        const ACCESS_TOKEN = 'pk.eyJ1Ijoib2xpdmlhdDEwIiwiYSI6ImNsdXZ3aDYzcjA2bW0yaWwzZ3g2cXA2bWYifQ.YFXEBTfX3eiQrk5pm5qBVQ';

        mapboxgl.accessToken = ACCESS_TOKEN;

        const searchJS = document.getElementById('search-js');
        searchJS.onload = function () {
            const searchBox = new MapboxSearchBox();
            searchBox.accessToken = ACCESS_TOKEN;
            searchBox.options = {
                types: 'address,poi',
                proximity: [-73.99209, 40.68933]
            };

            //search box
            map.addControl(searchBox);

            // zoom and rotation controls
            map.addControl(new mapboxgl.NavigationControl());
        };
    </script>

    <script src='map.js'></script>

</body>

</html>
